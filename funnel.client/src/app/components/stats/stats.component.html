<div class="row" style="text-align: left;"><h3>Consulta general de estadisticas</h3></div>
<div class="row">
  <div class="row contenedorTabla">
    <!-- Mostrar un indicador de carga si la variable loading es true -->
    <div *ngIf="loading">Cargando...</div>
    <p-table
      *ngIf="!loading && stats.length > 0"
      #dt
      [stripedRows]="true"
      [value]="stats"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[10, 20, 50]"
      (onPage)="pageChange($event)"
      [showCurrentPageReport]="true"
      paginatorPosition="both"
      [columnResizeMode]="'fit'"
      [resizableColumns]="true"
      [scrollable]="true"
      [first]="first"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} Registros"

    >

    <ng-template class="divAccionesTabla" #caption>
      <div class="row">
          <div class="col inDivDatatableHeader" style="text-align:right; margin-right:5px">
              <p-button label="" icon="pi pi-refresh" (click)="reset()"severity="secondary"
                  [ngStyle]="{'margin-right': '5px'}" />
          </div>
      </div>
  </ng-template>

      <ng-template #header>
        <tr class="custom-header">
          <th pSortableColumn="empresa">
            Nombre empresa
          </th>
          <th pSortableColumn="usuariosActivos">Usuarios Activos</th>
          <th pSortableColumn="usuariosRegistrados">
            Usuarios Registrados
          </th>
          <th pSortableColumn="oportunidadesActivas">
            Oportunidades Activas
          </th>
          <th pSortableColumn="oportunidadesRegistradas" >
            Oportunidades Regristradas
          </th>
          <th pSortableColumn="estatus">
            Estatus
          </th>
        </tr>
        <tr class="custom-header2">
          <th> <input pInputText  [ngStyle]="{'width': '100%'}" type="text" [(ngModel)]="filterStatus" (ngModelChange)="updateFilter($event, 'empresa')"></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>
            <p-select
              [options]="EstatusDropdown"
              [(ngModel)]="selectedEstatus"
              (onChange)="FiltrarPorEstatus()"
              placeholder="Seleccionar Estatus"
              optionLabel="label"
              optionValue="value"
              [appendTo]="'body'"
            >
            </p-select>
          </th>
        </tr>
      </ng-template>

      <ng-template #body let-stat>
        <tr class="custom-header3 custom-row filas">
          <td style="font-weight: bold;">{{ stat.empresa }}</td>
          <td>{{ stat.oportunidadesActivas }}</td>
          <td>{{ stat.oportunidadesRegistradas }}</td>
          <td>{{ stat.usuariosActivos }}</td>
          <td>{{ stat.usuariosRegistrados }}</td>
          <td>{{ stat.estatus === true ? "Activo" : "Inactivo" }}</td>
        </tr>
      </ng-template>
      <ng-template #footer>
        <tr class="custom-footer ">
          <td>Total: </td>
          <td>{{ getVisibleTotal('oportunidadesActivas',dt) }}</td>
          <td> {{ getVisibleTotal('oportunidadesRegistradas',dt) }}</td>
          <td>{{ getVisibleTotal('usuariosActivos',dt) }}</td>
          <td>{{ getVisibleTotal('usuariosRegistrados',dt) }}</td>
          <td></td>
        </tr>
      </ng-template>
    </p-table>
  </div>
  <p-toast position="center"></p-toast>
</div>

