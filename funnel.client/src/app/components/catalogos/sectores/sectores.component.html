<div class="row" style="text-align: left; font-weight: bold;">
  <h3>Administración General de Sectores</h3>
</div>

<div class="row">
  <div class="row contenedorTabla">
    <div *ngIf="loading">Cargando...</div>

    <p-table
      *ngIf="!loading && sectores.length > 0"
      #dt
      [stripedRows]="true"
      [value]="sectores"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[10, 20, 50]"
      (onPage)="pageChange($event)"
      [first]="first"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} Registros"
      [globalFilterFields]="['nombreLicencia']">

      <ng-template class="divAccionesTabla" #caption>
        <div class="row">
          <div class="col inDivDatatableHeader" style="text-align: left;">
            <p-iconfield iconPosition="left" class="ml-auto">
              <p-inputicon>
                <i class="pi pi-search"></i>
              </p-inputicon>
              <input pInputText type="text" (input)="onInput($event)" placeholder="Buscar" />
            </p-iconfield>
          </div>

          <div class="col inDivDatatableHeader">
            <div class="mb-4">
              <p-button type="button" icon="pi pi-chevron-left" (click)="prev()" class="Iconos" [disabled]="isFirstPage()" text />
              <p-button type="button" icon="pi pi-refresh" class="Iconos" (click)="reset()" text />
              <p-button type="button" icon="pi pi-chevron-right" class="Iconos" (click)="next()" [disabled]="isLastPage()" text />
            </div>
          </div>

          <div class="col inDivDatatableHeader" style="text-align: right; margin-right: 5px;">
            <p-button label="" icon="pi pi-plus" severity="secondary" (click)="inserta()" />
          </div>
        </div>
      </ng-template>

      <ng-template #header>
        <tr class="custom-header">
          <th></th>
          <th pSortableColumn="nombreSector">Sector <p-sortIcon field="nombreSector" /></th>
          <th pSortableColumn="descripcionSector">Descripción Sector <p-sortIcon field="cantidadUsuarios" /></th>
          <th pSortableColumn="fechaCreacion">Fecha Creación <p-sortIcon field="fechaCreacion" /></th>
          <th pSortableColumn="usuarioCreador">Usuario Creador <p-sortIcon field="usuarioCreador" /></th>
          <th pSortableColumn="fechaModificacion">Fecha Modificación <p-sortIcon field="fechaModificacion" /></th>
          <th pSortableColumn="usuarioModifico">Usuario Modificó<p-sortIcon field="usuarioModifico" /></th>
          <th pSortableColumn="desEstatusActivo">Estatus <p-sortIcon field="desEstatusActivo" /></th>
        </tr>
        <tr class="custom-header2">
          <th></th>
          <th>
            <p-columnFilter
              type="text"
              field="nombreSector"
              placeholder=""
              ariaLabel="nombreSector"
              class="hide-filter-icon"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="descripcionSector"
              ariaLabel="descripcionSector"
              class="hide-filter-icon custom-width"
              style="width: 50px !important"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="fechaCreacion"
              placeholder=""
              ariaLabel="fechaCreacion"
              class="hide-filter-icon custom-width2"
            ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
            type="text"
            field="usuarioCreador"
            placeholder=""
            ariaLabel="usuarioCreador"
            class="hide-filter-icon custom-width2"
          ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
            type="text"
            field="fechaModificacion"
            placeholder=""
            ariaLabel="fechaModificacion"
            class="hide-filter-icon custom-width2"
          ></p-columnFilter>
          </th>
          <th>
            <p-columnFilter
              type="text"
              field="usuarioModifico"
              placeholder=""
              ariaLabel="usuarioModifico"
              class="hide-filter-icon custom-width3"
            ></p-columnFilter>
          </th>

          <th>
            <p-select
              [options]="EstatusDropdown"
              [(ngModel)]="selectedEstatus"
              (onChange)="FiltrarPorEstatus()"
              optionLabel="label"
              optionValue="value"
            >
            </p-select>
          </th>
        </tr>
      </ng-template>

      <ng-template #body let-sector>
        <tr class="custom-header3 custom-row">
          <td>
            <p-button type="button" icon="pi pi-pencil" (click)="actualiza(sector)" text />
          </td>
          <td>{{ sector.nombreSector }}</td>
          <td>{{ sector.descripcionSector }}</td>
          <td>{{ sector.fechaCreacion }}</td>
          <td>{{ sector.usuarioCreador }}</td>
          <td>{{ sector.fechaModificacion }}</td>
          <td>{{ sector.usuarioModifico }}</td>
          <td>{{ sector.desEstatusActivo }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-toast position="center"></p-toast>
</div>

<app-modal-sectores
  [(visible)]="modalVisible"
  [title]="'Editar Datos de '"
  (closeModal)="onModalClose()"
  (result)="manejarResultado($event)"
  [insertar]="insertar"
  [sector]="sectorSeleccionado">
</app-modal-sectores>
