<div class="row" style="text-align: left; font-weight: bold;">
  <h3>Administración General de Sectores</h3>
</div>

<div class="row">
  <div class="row contenedorTabla">
    <div *ngIf="loading">Cargando...</div>

    <p-table
      *ngIf="!loading && sectores.length > 0"
      #dt
      [stripedRows]="true"
      [value]="sectores"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[10, 20, 50]"
      (onPage)="pageChange($event)"
      [first]="first"
      [showCurrentPageReport]="true"
      paginatorPosition="both"
      [columnResizeMode]="'fit'"
      [columnResizeMode]="'fit'"
                    [resizableColumns]="true" [scrollable]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} Registros">
      <ng-template class="divAccionesTabla" #caption>
        <div class="row">
            <div class="col inDivDatatableHeader" style="text-align:right; margin-right:5px">
                <p-button label="" icon="pi pi-refresh" (click)="reset()"severity="secondary"
                    [ngStyle]="{'margin-right': '5px'}" />
                <p-button label="" icon="pi pi-plus" severity="secondary"
                    (click)="inserta()" />
            </div>
        </div>
    </ng-template>

      <ng-template #header>
        <tr class="custom-header">
          <th></th>
          <th pSortableColumn="nombreSector">Sector </th>
          <th pSortableColumn="descripcionSector">Descripción Sector</th>
          <th pSortableColumn="fechaCreacion">Fecha Creación </th>
          <th pSortableColumn="usuarioCreador">Usuario Creador </th>
          <th pSortableColumn="fechaModificacion">Fecha Modificación</th>
          <th pSortableColumn="usuarioModifico">Usuario Modificó</th>
          <th pSortableColumn="desEstatusActivo">Estatus </th>
        </tr>
        <tr class="custom-header2">
          <th></th>
          <th>
            <input pInputText  type="text" [(ngModel)]="filtroSector" (ngModelChange)="updateFilter($event, 'nombreSector')">
          </th>
          <th>
            <input pInputText  type="text" [(ngModel)]="filtrODescSector" (ngModelChange)="updateFilter($event, 'descripcionSector')">
          </th>
          <th>
            <input pInputText  type="text" [(ngModel)]="filtroFechaCreacion" (ngModelChange)="updateFilter($event, 'fechaCreacion')">
          </th>
          <th>
            <input pInputText  type="text" [(ngModel)]="filtroUsuarioCreador" (ngModelChange)="updateFilter($event, 'usuarioCreador')">
          </th>
          <th>
          <input pInputText  type="text" [(ngModel)]="filtroFechaModificacion" (ngModelChange)="updateFilter($event, 'fechaModificacion')">
          </th>
          <th>
            <input pInputText  type="text" [(ngModel)]="filtroUsuarioModifico" (ngModelChange)="updateFilter($event, 'usuarioModifico')">
          </th>

          <th>
            <p-select
              [options]="EstatusDropdown"
              [(ngModel)]="selectedEstatus"
              [appendTo]="'body'"
              (onChange)="FiltrarPorEstatus()"
              optionLabel="label"
              optionValue="value"
            >
            </p-select>
          </th>
        </tr>
      </ng-template>

      <ng-template #body let-sector>
        <tr class="custom-header3 custom-row filas">
          <td>
            <p-button type="button" icon="pi pi-pencil" (click)="actualiza(sector)" text />
          </td>
          <td style="font-weight: bold;">{{ sector.nombreSector }}</td>
          <td>{{ sector.descripcionSector }}</td>
          <td>{{ sector.fechaCreacion }}</td>
          <td>{{ sector.usuarioCreador }}</td>
          <td>{{ sector.fechaModificacion }}</td>
          <td>{{ sector.usuarioModifico }}</td>
          <td>{{ sector.desEstatusActivo }}</td>
        </tr>
      </ng-template>
      <ng-template #footer>
        <tr class="custom-footer " >
          <td></td>
          <td colspan="7">Total: {{ getVisibleTotal('nombreSector',dt) }}</td>

        </tr>
      </ng-template>
    </p-table>
  </div>

  <p-toast position="center"></p-toast>
</div>

<app-modal-sectores
  [(visible)]="modalVisible"
  [title]="'Editar Datos de '"
  (closeModal)="onModalClose()"
  (result)="manejarResultado($event)"
  [insertar]="insertar"
  [sector]="sectorSeleccionado"
  [sectores]="sectores">
</app-modal-sectores>
